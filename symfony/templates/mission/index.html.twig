{% extends 'base.html.twig' %}

{% block title %}Hello MissionController!{% endblock %}

{% block body %}

<style>
    #missionstable tbody tr {
        cursor: pointer;
    }
</style>

<div class="container">
    <div class="row">
        <div class="col">
            <table
                    id="missionstable"
                    data-toolbar="#toolbar"
                    data-search="true"
                    data-show-columns="true"
                    data-show-columns-toggle-all="true"
                    data-detail-formatter="detailFormatter"
                    data-pagination="true"
                    data-id-field="id"
                    data-page-list="[10, 25, 50, 100, all]"
                    data-show-footer="false"
                    data-side-pagination="server"
                    data-url="missions/get-missions"
                    data-response-handler="responseHandler">
            </table>
        </div>
    </div>
</div>

<script>
    var $table = $('#missionstable')
    var selections = []

    function responseHandler(res) {
        $.each(res.rows, (i, row) => {
            row.state = $.inArray(row.id, selections) !== -1
        })
        return res
    }

    function initTable() {
        $table.bootstrapTable('destroy').bootstrapTable({
            height: 550,
            locale: 'en-US',
            columns: [
                [
                    {
                        field: 'idmission',
                        title: 'ID',
                        align: 'center',
                        valign: 'middle',
                        sortable: true
                    },{
                        field: 'code',
                        title: 'Code',
                        sortable: true,
                        align: 'center'
                    },{
                        field: 'title',
                        title: 'Title',
                        sortable: true,
                        align: 'center'
                    },{
                        field: 'country',
                        title: 'Country',
                        sortable: true,
                        align: 'center'
                    },{
                        field: 'type',
                        title: 'Type',
                        sortable: true,
                        align: 'center'
                    },{
                        field: 'start',
                        title: 'Start',
                        sortable: true,
                        align: 'center'
                    },{
                        field: 'end',
                        title: 'End',
                        sortable: true,
                        align: 'center'
                    }
                ]
            ]
        })

        // Event to load the modal description
        $table.on('click-cell.bs.table', (field, value, row, $el) => {
            console.log($el.idmission);
        });
    }

    $(function() {
        initTable();
    })
</script>

{% endblock %}
