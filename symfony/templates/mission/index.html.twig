{% extends 'base.html.twig' %}

{% block title %}Hello MissionController!{% endblock %}

{% block body %}

<style>
    .select,
    #locale {
        width: 100%;
    }
    .like {
        margin-right: 10px;
    }
</style>

<div class="container">
    <div class="row">
        <div class="col">
            <table
                    id="table"
                    data-toolbar="#toolbar"
                    data-search="true"
                    data-show-columns="true"
                    data-show-columns-toggle-all="true"
                    data-detail-view="true"
                    data-click-to-select="true"
                    data-detail-formatter="detailFormatter"
                    data-minimum-count-columns="2"
                    data-pagination="true"
                    data-id-field="id"
                    data-page-list="[10, 25, 50, 100, all]"
                    data-show-footer="false"
                    data-side-pagination="server"
                    data-url="missions/get-missions"
                    data-response-handler="responseHandler">
            </table>
        </div>
    </div>
</div>

<script>
    var $table = $('#table')
    var $remove = $('#remove')
    var selections = []

    function getIdSelections() {
        return $.map($table.bootstrapTable('getSelections'), function (row) {
            return row.id
        })
    }

    function responseHandler(res) {
        $.each(res.rows, function (i, row) {
            row.state = $.inArray(row.id, selections) !== -1
        })
        return res
    }

    function detailFormatter(index, row) {
        var html = []
        $.each(row, function (key, value) {
            html.push('<p><b>' + key + ':</b> ' + value + '</p>')
        })
        return html.join('')
    }

    function totalTextFormatter(data) {
        return 'Total'
    }

    function totalNameFormatter(data) {
        return data.length
    }

    /*function linkFormatter(value, row) {
        return "<a href='" + row.url + "'>" + row.nice_name + "</a>";
    }*/

    function initTable() {
        $table.bootstrapTable('destroy').bootstrapTable({
            height: 550,
            locale: 'fr-FR',
            columns: [
                [
                    {
                        field: 'idmission',
                        title: 'ID',
                        align: 'center',
                        valign: 'middle',
                        sortable: true
                    },{
                        field: 'code',
                        title: 'Code',
                        sortable: true,
                        align: 'center'
                    },{
                        field: 'title',
                        title: 'Title',
                        sortable: true,
                        align: 'center'
                    },{
                        field: 'country',
                        title: 'Pays',
                        sortable: true,
                        align: 'center'
                    },{
                        field: 'type',
                        title: 'Type',
                        sortable: true,
                        align: 'center'
                    },{
                        field: 'start',
                        title: 'DÃ©but',
                        sortable: true,
                        align: 'center'
                    },{
                        field: 'end',
                        title: 'Fin',
                        sortable: true,
                        align: 'center'
                    }
                ]
            ]
        })
    }

    $(function() {
        initTable()

        $('#locale').change(initTable)
    })
</script>

{% endblock %}
